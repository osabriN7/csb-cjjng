(this["webpackJsonpreact-three-fiber-importing-scenes-with-actions-from-blender"]=this["webpackJsonpreact-three-fiber-importing-scenes-with-actions-from-blender"]||[]).push([[0],{103:function(e,t,a){},104:function(e,t,a){},106:function(e,t,a){},107:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(16),o=a.n(i),c=(a(66),a(14)),l=a(19),s=(a(71),function(e){var t=e.data,a=void 0===t?[]:t;return r.a.createElement("div",{className:"d-tree"},r.a.createElement("ul",{className:"d-flex d-tree-container flex-column"},a.map((function(e){return r.a.createElement(d,{node:e})}))))}),d=function(e){var t=e.node,a=Object(n.useState)(!1),i=Object(c.a)(a,2),o=i[0],d=i[1],m=!!t.children;return r.a.createElement("li",{className:"d-tree-node border-0"},r.a.createElement("div",{className:"d-flex",onClick:function(e){return d((function(e){return!e}))}},m&&r.a.createElement("div",{className:"d-inline d-tree-toggler ".concat(o?"active":"")},r.a.createElement(l.a,{icon:"caret-right"})),r.a.createElement("div",{className:"col pl2 d-tree-head"},r.a.createElement("i",{className:""},r.a.createElement(l.a,{icon:"project-diagram"})," "),t.name)),m&&o&&r.a.createElement("div",{className:"d-tree-content"},r.a.createElement("ul",{className:"d-flex d-tree-container flex-column"},r.a.createElement(s,{data:t.children}))))},m=s,g=a(21),u=a(3),h=a(9),f=a(22),p=a(7),v=a(8),E=a(11),w=a.n(E),b=a(54),x=a.n(b),y=a(42),k=(a(24),a(47));a(60);k.a.preload("/kick.glb"),k.a.preload("/file-1614790270747.glb"),k.a.preload("/animated-sphere.glb"),k.a.preload("/uh60helico.glb");a(77);var S=a(144),D=a(108),N=a(147),A=Object(S.a)((function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(1),textAlign:"center",color:e.palette.text.secondary}}}));function C(e){var t=e.matrix,a=void 0===t?[]:t,n=A();function i(e){var t=e.data,a=void 0===t?[]:t;return r.a.createElement(r.a.Fragment,null,a.map((function(e){return r.a.createElement(N.a,{item:!0,xs:3},r.a.createElement(D.a,{className:n.paper},e))})))}return r.a.createElement("div",{className:n.root},r.a.createElement(N.a,{container:!0},a.map((function(e){return r.a.createElement(N.a,{container:!0,item:!0,xs:12},r.a.createElement(i,{data:e}))}))))}a(72),a(103);var I=function(e){var t=e.diagram,a=Object(n.useState)(1),i=Object(c.a)(a,2),o=i[0],s=i[1],d=function(e){s(e)};return r.a.createElement("div",{className:""},r.a.createElement("div",{className:"bloc-tabs"},r.a.createElement("button",{style:{width:"200px"},className:1===o?"tabs active-tabs":"tabs",onClick:function(){return d(1)}},"Diagram"),r.a.createElement("button",{style:{width:"200px"},className:2===o?"tabs active-tabs":"tabs",onClick:function(){return d(2)}},"MatrixView")),r.a.createElement("div",{className:"container-fluid content-tabs"},r.a.createElement("div",{className:1===o?"content active-content":"content"},r.a.createElement("div",{class:"wrapper"},r.a.createElement("div",{class:"palette"},r.a.createElement("div",null,r.a.createElement("label",{class:"text-center p-1 mb-2",style:{width:"100%"},for:"Nodes"},r.a.createElement(l.a,{icon:"caret-down"})," Nodes")),r.a.createElement("div",{class:"border border-dark marging-left-5",style:{width:"190px"}},r.a.createElement(y.NodeListView,{style:{height:"80px",width:"185px"},nodes:t.state.nodes,captions:t.state.captions})),r.a.createElement("div",null,r.a.createElement("label",{class:"text-center p-1 mb-2",style:{width:"100%"},for:"Nodes"},r.a.createElement(l.a,{icon:"caret-down"})," ArrowShapes")),r.a.createElement("div",{style:{width:"190px"},class:"border border-dark marging-left-5"},r.a.createElement(y.NodeListView,{onNodeSelected:function(e,a){return t.onSelectedLinkChanged(e,a)},style:{height:"80px",width:"185px"},nodes:t.state.arrowHeadShapes,captions:t.state.arrowHeadNames})),r.a.createElement("label",{class:"text-center p-1 mb-2",style:{width:"100%"},for:"Nodes"},r.a.createElement(l.a,{icon:"caret-down"})," AddPort"),r.a.createElement("div",{class:"border border-dark marging-left-5",style:{width:"190px"}},r.a.createElement(y.NodeListView,{onNodeSelected:function(e,a){return t.onSelectedPortAdded(e,a)},style:{height:"80px",width:"185px"},nodes:t.state.arrowInOuts,captions:t.state.arrowInOutName}))),r.a.createElement("div",{id:"diagram",class:"diaram"},r.a.createElement(y.DiagramView,Object.assign({diagram:t.state.diagram},t.state.props,{style:{height:"600px "}}))))),r.a.createElement("div",{className:2===o?"content  active-content":"content"},r.a.createElement(C,{matrix:t.state.matrix}))))},P=a(149),L=a(150),F=a(154),O=a(153),T=a(151),j=a(152),J=a(156),R=a(155),M=(a(104),Object(S.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)}}})));function H(e){var t=e.diagram,a=M(),n=r.a.useState(""),i=Object(c.a)(n,2),o=i[0],s=i[1];return r.a.createElement("div",{className:a.root},r.a.createElement(P.a,{position:"static"},r.a.createElement(L.a,{style:{marginLeft:"-12px",marginRight:"-12px",backgroundColor:"#808080"}},r.a.createElement("div",null,r.a.createElement(T.a,{color:"inherit"},r.a.createElement(l.a,{icon:"upload"}),r.a.createElement("input",{style:{position:"relative",right:"20px",opacity:"0",width:"50px"},type:"file",onChange:function(e){return function(e){var a=e.target.files,n=new FileReader;n.readAsText(a[0]),n.onload=function(e){var a=e.target.result,n=JSON.parse(a),r=n.functions,i=[];t.drawTree(r,null),i=t.state.containers;for(var o=0;o<n.links.length;o++){var c=n.links[o].origin,l=n.links[o].target,s=i.find((function(e){return e.name===c})),d=i.find((function(e){return e.name===l})),m=new w.a.Diagramming.DiagramLink(t.state.diagram,s.container,d.container);s.container.getAnchorPattern();console.log(m.setOriginAnchor(4)),m.setShape(w.a.Diagramming.LinkShape.Cascading),m.setHeadBrush("blue"),m.setHeadShape("Triangle"),m.setHeadShapeSize(3),t.state.diagram.addItem(m)}t.arrangeDiagram(t.state.diagram),t.setState({treeData:t.getDiagramJson()});var g=t.getAllFunNames(r).map((function(e){return[e]}));console.log(g),t.setState({matrix:g})}}(e)}}))),r.a.createElement(j.a,{className:a.formControl},r.a.createElement(R.a,{id:"demo-simple-select-helper-label"},"LinkType"),r.a.createElement(F.a,{labelId:"demo-simple-select-helper-label",id:"demo-simple-select-helper",value:o,onChange:function(e){s(e.target.value),t.state.diagram.setLinkShape(e.target.value),2===e.target.value?t.state.diagram.setRouteLinks(!0):t.state.diagram.setRouteLinks(!1)}},r.a.createElement(J.a,{value:"3"},r.a.createElement("em",null,"None")),r.a.createElement(J.a,{value:2},"Cascading"),r.a.createElement(J.a,{value:0},"Bezir"),r.a.createElement(J.a,{value:3},"Spline"),r.a.createElement(J.a,{value:1},"Polyline")),r.a.createElement(O.a,null,"Please choose your link type")),r.a.createElement(T.a,{onClick:function(e){var a=t.state.diagram.getZoomFactor();(a+=10)<500&&t.state.diagram.setZoomFactor(a)},color:"inherit"},r.a.createElement(l.a,{icon:"search-plus"})),r.a.createElement(T.a,{onClick:function(e){var a=t.state.diagram.getZoomFactor();(a-=10)>10&&t.state.diagram.setZoomFactor(a)},color:"inherit"},r.a.createElement(l.a,{icon:"search-minus"})),r.a.createElement(T.a,{onClick:function(e){var a=t.state.diagram.getSelection().nodes,n=[];if(a.length>0)if((n=a[0].getChildren()).length>0&&n[0].getVisible())n.forEach((function(e){e.getAllLinks().forEach((function(e){e.setVisible(!1)})),e.setVisible(!1)}));else{if(!(n.length>0))return;n.forEach((function(e){e.getAllLinks().forEach((function(e){e.setVisible(!0)})),e.setVisible(!0)}))}},color:"inherit"},r.a.createElement(l.a,{icon:"unlock"})),r.a.createElement(T.a,{onClick:function(){t.state.diagram.undo(),t.setState({treeData:t.getDiagramJson()})},color:"inherit"},r.a.createElement(l.a,{icon:"arrow-left"})),r.a.createElement(T.a,{onClick:function(){t.state.diagram.redo(),t.setState({treeData:t.getDiagramJson()})},color:"inherit"},r.a.createElement(l.a,{icon:"arrow-right"})),r.a.createElement("div",null,r.a.createElement(T.a,{color:"inherit"},r.a.createElement(l.a,{icon:"upload"}),r.a.createElement("input",{style:{position:"relative",right:"20px",opacity:"0",width:"50px"},type:"file",onChange:function(e){return function(e){var a=e.target.files,n=new FileReader;n.readAsText(a[0]),n.onload=function(e){var a=e.target.result,n=JSON.parse(a);n.unshift([r.a.createElement(l.a,{icon:"project-diagram"})]);var i=t.state.matrix;i.unshift(n);for(var o=1;o<i.length;o++){for(var c=[],s=0;s<n.length;s++)c[s]=0===s?i[o][0]:r.a.createElement("button",{style:{width:"20px",height:"20px"},id:o+","+s,type:"button",onClick:t.fct});i[o]=c}t.setState({matrix:i})}}(e)}}))))))}var V=a(38),Z=a(13);V.b.add(Z.l,Z.f,Z.b,Z.c,Z.q,Z.r,Z.t,Z.A,Z.v,Z.u,Z.C,Z.B,Z.j,Z.p,Z.m,Z.n,Z.d,Z.a,Z.k,Z.i,Z.e,Z.z,Z.w,Z.y,Z.x,Z.s,Z.h,Z.o,Z.g);a(106);var B=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var n;Object(u.a)(this,a),(n=t.call(this,e)).getAllChildren=function(e){return 0===e.length?[]:[{id:e[0].id,name:e[0].text.text,children:e[0].children.map((function(e){return n.getAllChildren(e)}))}]},n.findRec=function(e,t){if(e.length>0&&e[0].id===t)return e[0];if(e.length>0){var a=n.findRec(e[0].children,t);return a||n.findRec(e.slice(1),t)}},n.filterRec=function(e,t){return e.filter((function(e){return e.id!=t})).map((function(e){return{id:e.id,name:e.name,children:n.filterRec(e.children,t)}}))},n.exist=function(e,t,a){return 0!==a.length&&(e===a[0].x&&t===a[0].y||n.exist(e,t,a.slice(1)))},n.goodForma=function(e,t){return 0!==e&&0===t&&e<100||0===e&&0!==t&&t<100||0!==e&&100===t&&e<100||100===e&&0!==t&&t<100},n.addTocontainer=function(e,t){t.add(e),t.resizeToFitChildren(!0,2),t.arrange(new w.a.Graphs.LayeredLayout)},n.drawFct=function(e,t){var a=t.getFactory().createContainerNode(new x.a.Drawing.Rect(10,20,50,25));a.setText(e.name),a.setId(n.state.nextId);for(var r=e.ports,i=[],o=0;o<r.length;o++){var c=null;"in"==r[o].type?o<9?c=new w.a.Diagramming.AnchorPoint(10*(o+1),0,!0,!1):o<18?c=new w.a.Diagramming.AnchorPoint(0,10*(o-8),!0,!1):o<27?c=new w.a.Diagramming.AnchorPoint(10*(o-17),100,!0,!1):o<38&&(c=new w.a.Diagramming.AnchorPoint(100,o-26,!0,!1)):"out"==r[o].type?o<9?c=new w.a.Diagramming.AnchorPoint(10*(o+1),0,!1,!0):o<18?c=new w.a.Diagramming.AnchorPoint(10*(o-8),0,!1,!0):o<27?c=new w.a.Diagramming.AnchorPoint(10*(o-17),100,!1,!0):o<38&&(c=new w.a.Diagramming.AnchorPoint(100,o-26,!1,!0)):o<9?c=new w.a.Diagramming.AnchorPoint(10*(o+1),0,!0,!0):o<18?c=new w.a.Diagramming.AnchorPoint(10*(o-8),0,!0,!0):o<27?c=new w.a.Diagramming.AnchorPoint(10*(o-17),100,!0,!0):o<38&&(c=new w.a.Diagramming.AnchorPoint(100,o-26,!0,!0)),c.setMarkStyle(w.a.Diagramming.MarkStyle.Rectangle),c.setColor("rgb(128, 255, 255)"),i.push(c)}var l=new w.a.Diagramming.AnchorPattern(i);a.setAnchorPattern(l);var s={name:e.name,id:n.state.nextId,container:a};return n.state.containers.push(s),n.setState({nextId:n.state.nextId+1}),e.children&&n.drawTree(e.children,a),s},n.drawTree=function(e,t){if(t)return e.map((function(e){return n.addTocontainer(n.drawFct(e,n.state.diagram).container,t)}));e.map((function(e){return n.drawFct(e,n.state.diagram)}))},n.fct=function(){},n.findInChild=function(e,t){return 0!==e.length&&(!!n.findRec(e[0].children,t)||n.findInChild(e.slice(1),t))},n.filterJson=function(e){for(var t=e,a=0;a<e.length;a++)n.findInChild(t,e[a].id)&&(t=t.filter((function(t){return t.id!=e[a].id})));return t=t.filter((function(e){return e.id}))},n.getAllFunNames=function(e){var t=e.map((function(e){return e.name}));return e.map((function(e){return n.getAllFunNames(e.children)})).flat().concat(t)},n.getDiagramJson=function(){for(var e=n.state.diagram.items,t=[],a=0;a<e.length;a++)t.push(n.getFctJson(e[a]));return n.filterJson(t)},n.getFctJson=function(e){return e.children&&0!=e.children.length?{id:e.id,name:e.text.text,children:e.children.map((function(e){return n.getFctJson(e)}))}:{id:e.id,name:e.text.text,children:[]}};var r=new w.a.Diagramming.Diagram;r.setShowGrid(!0),r.setDefaultShape("Container"),r.setLinkShape(w.a.Diagramming.LinkShape.Spline),r.setTheme(w.a.Diagramming.Theme.getBusiness());e={id:"diagram1",backBrush:"#0a0a0a",behavior:w.a.Diagramming.Behavior.LinkContainers};var i=w.a.Diagramming.AeroEffect,o=w.a.Diagramming.GlassEffect,c=w.a.Diagramming.GlassEffectType,l=new o;l.setType(c.Type2),r.getNodeEffects().push(l),r.getNodeEffects().push(new i);var s=r.getNodes()[0];[].push(s);var d=[],m=[],g=["Actor","Plaque","Database","File"],h=["Quill","PointerArrow","Pentagon"],p=[],v=new w.a.Diagramming.ContainerNode;d.push(v);for(var E=0;E<g.length;E++)(v=new w.a.Diagramming.ShapeNode(r)).setShape(g[E]),d.push(v);for(var b=0,y=h;b<y.length;b++){var k=y[b],S=new w.a.Diagramming.ShapeNode(r);S.setShape(k),p.push(S)}var D=new w.a.Diagramming.ShapeNode(r);D.setId("inPut"),D.setShape("Arrow3"),m.push(D);var N=new w.a.Diagramming.ShapeNode(r);N.setId("outPut"),N.setShape("Arrow3"),m.push(N);var A=new w.a.Diagramming.ShapeNode(r);return A.setId("all"),A.setShape("Arrow5"),m.push(A),r.setAllowInplaceEdit(!0),r.setUndoEnabled(!0),r.addEventListener("nodeCreated",n.onAddContainer.bind(Object(f.a)(n))),r.addEventListener("containerChildAdded",n.onContainerChildAdded.bind(Object(f.a)(n))),r.addEventListener("nodeTextEdited",n.onNodeTextEdited.bind(Object(f.a)(n))),r.addEventListener("nodeDeleted",n.onNodeDeleted.bind(Object(f.a)(n))),n.state={props:e,matrix:[],diagram:r,nextId:1,containers:[],treeData:[],nodes:d,captions:["Function","Actor","Plaque","Database","File"],arrowInOuts:m,arrowInOutName:["InPut","OutPut","InPut/OutPut"],arrowHeadShapes:p,arrowHeadIds:h,arrowHeadNames:["Informations","Energie","Material"],behavior:w.a.Diagramming.Behavior.LinkContainers},n}return Object(h.a)(a,[{key:"onAddContainer",value:function(e,t){console.log("ok");var a=t.getNode();a.setId(this.state.nextId.toString()),this.setState({treeData:this.getDiagramJson()});var n=this.state.matrix,i=[],o=n.length;if(i[0]=r.a.createElement("button",{style:{width:"20px",opacity:0,height:"20px"},type:"button"},a.getId()),n[0])for(var c=1;c<n[0].length;c++)i[c]=r.a.createElement("button",{style:{width:"20px",height:"20px"},id:o+","+c,type:"button",onClick:this.fct});n.push(i),this.setState({nextId:this.state.nextId+1})}},{key:"onContainerChildAdded",value:function(e,t){this.setState({treeData:this.getDiagramJson()})}},{key:"onNodeDeleted",value:function(e,t){var a=this;t.getNode().getChildren().forEach((function(e){return a.state.diagram.removeItem(e)})),this.setState({treeData:this.getDiagramJson()})}},{key:"onNodeTextEdited",value:function(e,t){var a=t.getNode(),n=a.getId(),r=this.state.matrix;this.setState({treeData:this.getDiagramJson()});for(var i=0;i<r.length;i++)r[i][0].props&&r[i][0].props.children===n&&(r[i][0]=a.getText())}},{key:"onSelectedLinkChanged",value:function(e,t){var a=t.getNode().getShape();this.state.diagram.setLinkHeadShape(a)}},{key:"arrangeDiagram",value:function(e){var t=new w.a.Graphs.SpringLayout;t.iteration=100,this.state.diagram.arrange(t),this.state.diagram.resizeToFitItems()}},{key:"onSelectChange",value:function(e){this.setState({behavior:+e.target.value})}},{key:"onSelectedLinkTypeChanged",value:function(e){this.state.diagram.setLinkShape(e.target.val),2===e.target.value?this.state.diagram.setRouteLinks(!0):this.state.diagram.setRouteLinks(!1)}},{key:"onSelectedPortAdded",value:function(e,t){var a=this.state.diagram.getSelection().nodes;if(a&&a.length>0){for(var n=a[0],r=[0,10,20,30,40,50,60,70,80,100],i=10,o=0,c=n.getAnchorPattern();!this.goodForma(i,o)||c&&this.exist(i,o,c.points);)i=r[Math.floor(Math.random()*r.length)],o=r[Math.floor(Math.random()*r.length)];var l=new w.a.Diagramming.AnchorPoint(i,o,!1,!1);if(l.setMarkStyle(w.a.Diagramming.MarkStyle.Rectangle),l.setColor("rgb(128, 255, 255)"),l.setSize(5),"inPut"==t.getNode().getId()?l.setAllowIncoming(!0):("outPut"==t.getNode().getId()||l.setAllowIncoming(!0),l.setAllowOutgoing(!0)),c){var s=c.getPoints();s.push(l),c.setPoints(s),n.setAnchorPattern(c)}else c=new w.a.Diagramming.AnchorPattern([l]),n.setAnchorPattern(c);console.log(c)}}},{key:"onZoomOutClicked",value:function(e){var t=this.state.diagram.getZoomFactor();(t-=10)>10&&this.state.diagram.setZoomFactor(t)}},{key:"onZoomInClicked",value:function(e){var t=this.state.diagram.getZoomFactor();(t+=10)<500&&this.state.diagram.setZoomFactor(t)}},{key:"getMaxId",value:function(e){var t=this;if(0===e.length)return 0;var a=e.map((function(e){return e.id})),n=e.map((function(e){return t.getMaxId(e.children)})),r=a.concat(n);return Math.max.apply(Math,Object(g.a)(r))}},{key:"render",value:function(){return r.a.createElement("div",{class:"container-fluid"},r.a.createElement("div",{class:"row"},r.a.createElement(H,{diagram:this})),r.a.createElement("div",{class:"row  mt-1  ",style:{height:"500px"}},r.a.createElement("div",{class:"col-sm-2 bg-secondary border border-dark rounded "},r.a.createElement("label",{class:"text-center p-1 mb-2",style:{width:"100%"},for:"Nodes"},r.a.createElement(l.a,{icon:"caret-down"})," TreeView"),r.a.createElement("div",{class:"border border-dark rounded",style:{height:"300px"}},r.a.createElement(m,{data:this.state.treeData}))),r.a.createElement("div",{class:" col-sm-10 bg-secondary rounded border border-dark  "},r.a.createElement(I,{matrix:this.state.matrix,diagram:this,props:this.state.props,nodeView:{nodes:this.state.nodes,captions:this.state.captions,arrowHeadShapes:this.state.arrowHeadShapes,arrowHeadNames:this.state.arrowHeadNames}}))),r.a.createElement("div",{class:"row"},r.a.createElement("div",{class:"col-sm-2 bg-light "}),r.a.createElement("div",{class:" col-sm-9 bg-light"}),r.a.createElement("div",{class:"col-sm-1 bg-light "})))}}]),a}(n.Component),G=document.getElementById("root");o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(B,null)),G)},66:function(e,t,a){},72:function(e,t,a){},85:function(e,t,a){e.exports=a(107)}},[[85,1,2]]]);
//# sourceMappingURL=main.dce4ae2c.chunk.js.map